/* natUIve – Navigation */

@import '../../css/natuive-setup';

.n-nav {
	
	vertical-align: baseline;
	display: inline-block;

	ul {
	
		margin: 0 0 0 -.5em;
		margin: 0;
		padding: 0;
		display: inline-block;
		width: auto;
		list-style: none;
		display: flex;
	    flex-wrap: wrap;

		li {
		
			margin: 0;
		
			&:last-child {
		
				margin-right: 0;
		
			}
	
		}
	
	}
	
	&.n-nav--scroll {
		
		overflow: auto;
		max-width: 100%;
		
		> ul {
			
			display: flex;
		    padding: .25em 0;
			flex-wrap: nowrap;
			white-space: nowrap;
	    		
		}
	
	}

	a {
		
		position: relative;
		padding: 0 .25em;

	}
	
	.active a[href] {
		
		text-decoration: none;
		opacity: .7;

	}
	
	&:not(.n-drop) a[href^='#'] {
		
		text-decoration: none;

	}
	
/*
	li:last-child a, li a {
		
		padding-right: 0;

	}
*/

	&.n-row {
		
		display: inline-flex;
	
	}
	
}

@supports (--a: 1) {
	
	.n-nav--scroll {
		
		a {
		
			padding: 0;

		}
		
		> ul {
	
		    overflow: auto;
		    max-width: 100%;
		    transform: translate3d(0, 0, 0); // Safari macOS bug fix when using scrollbars: Not working initially.
		    -webkit-overflow-scrolling: touch;
	
		}
	
		ul li {
	
		    padding: $line-height-em/2;
	
		}
	
	}

}

main .n-nav ul {

	padding-left: 0;

}
	
// Drop nav

$bg: inherit; // fallback for browsers unsupporting CSS variables

.n-drop {

    --bg: inherit;
    --color: inherit;
    
    color: var(--color);

	ul {
		
		padding: 0;
		margin: 0;
		min-height: 0;
		z-index: 1;

	
	}
	
	ul ul {
		
		padding: 0;
		position: absolute;
		left: 0;
// 		background-color: $bg;
		background-color: var(--bg);
		top: 100%;
	
	}
	
	ul ul ul {
		
		margin-left: 100%;
		top: 0;
	
	}
	
	ul li {
		
		display: inline-block;
		vertical-align: top;
		margin: 0;
		padding: 0;
		box-sizing: border-box;
// 		background-color: $nav-bg;
		background-color: var(--bg);
		position: relative;
		width: auto;
		
	}
	
	li:not([tabindex]) > ul ~ a {
	
		padding-right: 42px;
	
	}
	
	li > a {
		
		padding: .75em;
		display: block;
	
	}
	
	a:focus, li > :focus {
	
		outline-offset: -7px;
	
	}
	
	a[href] {
		
		position: relative;
	
	}
	
	li:not([aria-haspopup]) > a {
		
	//     margin-right: 42px;
		z-index: 0;
	// 	padding-right: 0;
		
	}
	
	ul[role=menubar] li > a {
		
	    margin-right: 0;
	    padding-right: 1em;
		
	}
	
	ul[role=menubar] li[aria-haspopup] > a {
		
	    margin-right: 0;
		padding-right: 1em;
		
	}
	
	li li {
		
		display: block;
		width: 100%;
	
	}
	
	ul ul:not([aria-expanded]) {
		
		min-height: 0;
		max-height: 0;
	// 	z-index: 2;
		overflow: hidden;
		position: absolute;
	
	}
	
	ul li > :checked ~ ul, :focus ~ ul, 
	a:focus ~ ul, ul ul[aria-expanded], li li ul[aria-expanded], li li:not(:focus) :checked ~ ul {
		
		max-height: none;
		overflow: visible;
		opacity: 1;
		z-index: 2;
	
	}
	
	ul ul[aria-expanded], li li ul[aria-expanded], li li:not(:focus) :checked ~ ul {
	
		z-index: 2; // Problem with CSS-only input method
	
	}
	
	li > input {
		
		-webkit-appearance: none;
		-moz-appearance: none;
		display: block;
		position: absolute;
	// 	margin: -4.75em 0 0 0;
		width: 100%; // iOS doesn't work with left/right
		height: 100%; 
		border: none;
		border-radius: 0;
		right: 0;
		z-index: 1;
		width: 2em;
					
	}
	
	li[aria-haspopup]:before {
		
		content: '' !important;
		position: absolute;
		display: block !important;
		right: 0;
		top: 0;
		width: 2em;
		height: 3rem;
		
	}
	
/* 	li > ul ~ a, */ li[aria-haspopup]:before, li > input {
		
/*
		background: url('data:image/svg+xml,%3Csvg%20width%3D%22100%22%20height%3D%22100%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%3Cpath%20fill%3D%22%23000%22%20d%3D%22M50%20100L0%200h100z%22%20fill-rule%3D%22evenodd%22/%3E%3C/svg%3E') calc(100% - 16px) 50% no-repeat;
		background-size: .5em auto;
*/
	
	    background: linear-gradient(-113deg, transparent 60%, var(--bg) 63%), linear-gradient(113deg, transparent 60%, var(--bg) 63%), linear-gradient(to bottom, var(--color), var(--color));
	    background-size: 1em 1em;
	    background-repeat: no-repeat;
		background-position: calc(100% - .5em) center;
		font-size: .75rem;
		margin: 0;
        
   	}
	
/*
	li > ul ~ a:before, li[aria-haspopup]:before {
		
		content: '▼' !important;
		display: inline-block !important;
		position: absolute;
		right: 1em;
		font-size: .67em;
		top: 50%;
		transform: rotate(0) translateY(-50%);
		transition: transform .2s ease-in-out;
	    transform-origin: top;			
	
	}
*/
	
	&[data-ready] li > ul ~ a {
		
		background: none;
		
	}
	
/* 	li li > ul ~ a, */ li li[aria-haspopup]:before, li li > input {
	
		background-image: linear-gradient(27deg,transparent 60%,var(--bg) 63%),linear-gradient(152deg,transparent 60%,var(--bg) 63%),linear-gradient(to bottom,var(--color),var(--color));
	
	}
	
	li[aria-haspopup] {
		
		padding-right: calc(42px - 1em);
					
	}

}
	
@media (min-width: 600px) {

	html:not(.can-touch) { // Hover rules here
		
		.n-drop {
		
			ul ul:not([aria-expanded]) ul {
			
				transition: .1s .2s;
				opacity: 0;
				position: absolute;
			
			}
			
			> ul > li > ul li {
				
// 				background-color: $nav-bg;
				background-color: var(--bg);
				
			}
	
			> ul 		> li:hover > input:not(:checked) ~ ul,
			> ul li ul > li:hover > input:not(:checked) ~ ul,
			> ul > li:not([aria-haspopup]):hover > input:not(:checked) ~ ul,
			> ul li:not([aria-haspopup]) ul li:hover > input:not(:checked) ~ ul {
				
				min-height: 0;
				max-height: 0;
				overflow: hidden;
				z-index: 1;
				position: absolute;
	
			}
	
			> ul > li:not([aria-haspopup]):hover > ul,
			> ul 		> li:hover > ul,
			> ul li ul > li:hover > ul,
			ul ul :checked ~ ul:not([aria-expanded]),
			> ul li:not([aria-haspopup]) ul li:hover ~ ul {
				
				max-height: none;
				overflow: visible;
				opacity: 1;
				z-index: 2;
				
			}
			
			> ul li ul li:hover ul {
	
				transition-delay: 0.2s;
	
			}
		
		}

	}

	nav.n-drop li {
		
		white-space: nowrap;
		
	}

}

@media (max-width: 599.9px) {

	.n-drop ul {
	
		ul:not([aria-expanded]) {
			
			position: static;
		
		}

		ul {
			
			position: static;
			width: calc(100% + 42px);
			padding-left: .5em;
			overflow: hidden;
			box-sizing: border-box;
		
			ul {
				
				margin: 0;	
		
			}

		}
	
		li {
			
			width: 100%;
		
			> input, &[aria-haspopup] {
				
				background-position-y: 1.5em;
			
			}
		
			&[aria-haspopup] {
				
				padding-right: 42px;
							
			}
	
		}
	
	}

}
