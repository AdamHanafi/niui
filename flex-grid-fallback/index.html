<!DOCTYPE html>

<!--
A grid of inline-block columns can have columns with explicit width and auto width columns. The space remaining after the explicit-width columns is distributed evenly between the rest of the columns. Columns have minimum width. When columns width exceed the available space, they are wrapped on a new row.
Used for fallback when Flexbox is not supported by the browser.
-->

<style>
	
	body {
		
		font-size: 16px;

	}
	
	.row {
	
		max-width: 1000px;
		margin: 0 auto;
		font-size: 0;
		text-align: left;
		
	}
	
	.row > * {
		
		font-size: 16px; /* To do: replace by actual font size of column's row's parent */
		min-width: 20%; /* To do: support +33% */
		display: inline-block;
		padding: .5em;
		margin: 0;
		border: none;
		color: #333;
		box-sizing: border-box;
		vertical-align: top;
		position: relative;
		word-wrap: break-word;

	}
	
	.row > * {
		
		max-width: 20%;
		
	}
	
	.row > * > * {
		

	}
	
	.row > *[class^=col] {
		
		max-width: none;

	}
	
	.row > .table-row {
		
		display: table;
		width: 100%;
		max-width: 100%;
		table-layout: fixed;
		border-spacing: .5em;
		border-collapse: separate;
		font-size: inherit;
		margin-bottom: -.5em;
		padding: 0;

	}

	.row > .table-row > * {
		
		display: table-cell;
		padding: .5em;
		background: #eee;
		vertical-align: top;
		word-wrap: break-word;

	}
	
	.row.no-spacing > .table-row {
		
		border-collapse: collapse;
		
	}
		
	.row.no-padding > .table-row > * {
		
		padding: 0;
		
	}
		
	.col1 {
		
		width: 100%;
		max-width: 100%;

	}
		
	.col2 {
		
		width: 50%;

	}
	
	.col3 {
		
		width: 33.333%;

	}
	
	.col23 {
		
		width: 66.667%;
		
	}

	.col4 {
		
		width: 25%;

	}
	
	.col34 {
	
		width: 75%;	
	
	}
	
	.col5 {
		
		width: 20%;	
		
	}
	
	.col25 {
	
		width: 40%;
	
	}
	
	.col35 {

		width: 60%;

	}
	
	.col45 {

		width: 80%;

	}
	
	.align-right {
		
		text-align: right;
		
	}
	
	.align-left {
		
		text-align: left;
		
	}
	
	.align-center {
		
		text-align: center;

	}
	
	.align-middle, .row > .table-row > .align-middle {
		
		vertical-align: middle;

	}
		
	.align-bottom, .row > .table-row > .align-bottom {
		
		vertical-align: middle;

	}
		
</style>

<!--
<div class='row no-spacing-' id=grid>
	
	<div class="col1"> 
		
		<h2>Row on: Wrapping Grid</h2> 
	
	</div>
	
	<div class="col2 align-bottom" style="background: #fee; color: #333;">
		
		<div>Use a grid with arbitrary cell elements inside .row. <button>Inline element</button></div>
	
	</div>
	<div class="col4" style="background: #efe; color: #333;">
		
		<div>Use vertical alignment in cells, it's finally easy and dependable.<p><br></p><p><br></p></div>
		
	</div>
	<div class="col4 align-right vertical-row" style="background: #eef; color: #333;">
		<div>Embed any kind of element into any container-type element: Cell, List, Slider, Fold (Accordion).</div>
		<div class="align-bottom" style="text-align: start;">Vertical row as tall as the parent row with equal-height full-width children</div>
	</div>
	<div style="background: #eff; color: #333;"><div>The grid is simpler and doesn't insist on the infamous 12 cols. Just add a div to a .row. Width classes, like .col23, are optional.</div></div>
	<div>
		
		<div>

			<span class="tool">
				This text has a tooltip.
			</span>
		
		</div>

	</div>

	<div>ThisLineIsTooLongAndMustBeClippedByTheContainerEvenThoughOverflowXandYDontWorkAsExpected</div>
	<div id=modal><h2> Modal Window </h2><a href="external.html#content" class="modal limited">Open a modal window inside this <span>tab</span>.</a></div>	
	<div>
	
		<a href="http://natuive.net/external.html#content" class="modal">Show external domain content in a modal window.</a> (On PHP enabled host)

	</div>
	<div class="col5">
		
		<h1> Headline 1 </h1>
		<h2> Headline 2 </h2>
		<h3> Headline 3 </h3>
		<h4> Headline 4 </h4>
		<h5> Headline 5 </h5>
		<h6> Headline 6 </h6>

	</div>

	<div class="col5" id=buttons>
		
		<div>
			
			<h2>Buttons</h2>
			
			<a href=# class=button>Small button</a>
			
			<br>
			
			<button disabled>Disabled button</button>
	
			<br>
			
			<a href=# class='button big'>Big button</a>
		
			<p id=copycontent>Here is an <a href=# class=button>Inline button</a> inside a paragraph.</p>

			<p>Click this <a class="button" id=copybutton>copy button</a> to copy the contents of the above paragraph to the clipboard.</p>

		</div>

	</div>	
	
	<div>
		
		<div class='row border-all'>
			
			<div>
				
				<div class="row">
				
					<div> <h2>Grid with borders</h2> </div>
				
					<div class='align-center align-middle'>
						
						<div>
		
							Middle
		
						</div>
				
					</div>
				
				</div>
				
				<div class="row">
					
					<div>
						
						<div>Full width</div>
					
					</div>
				
				</div>
				
				<div class="row">
				
					<div> <div>Top</div> </div>
					<div class="align-bottom align-center"> <div>Center Bottom</div> </div>
				
					<div class=align-right>
						
						<div>
							
							<div class="row">
								
								<div>Right</div>
							
							</div>
							
							<div class="row">
								
								<div>Right</div>
							
							</div>
						
						</div>
				
					</div>
				
				</div>
				
			</div>
			
		</div>
		
	</div>

</div>
-->

<div class='row'>
	
	<div class="col1"><div>Single column</div></div>	
	<div><div>Auto Auto Auto Auto Auto Auto Auto Auto Auto Auto Auto Auto Auto Auto </div></div>
	<div class="align-right"><div>Auto<br>Right-aligned</div></div>
	<div class="col2 align-center align-middle"><div>1/2<br>Centered</div></div>
	<div><div>Auto</div></div>
	<div><div>Auto</div></div>
	<div class="col23"><div>2/3</div></div>
	<div><div>Auto</div></div>
	<div><div>Auto</div></div>
	<div class="col3"><div>1/3</div></div>
	<div class="col23"><div>2/3</div></div>
	<div><div>Auto</div></div>
	<div><div>Auto</div></div>
	<div><div>Auto</div></div>
	<div><div>Auto Last</div></div>
		
</div>

<br><br>

<div class='row'>
	
	<div>Auto</div>
	<div>Auto</div>
	<div>Auto</div>
	<div>Auto</div>
	<div>Auto</div>
	<div>Auto</div>
	<div>Auto</div>
	<div>Auto</div>
	<div>Auto</div>
	<div>Auto</div>
	<div>Auto</div>
	<div>Auto</div>
	<div>Auto</div>
	<div>Auto</div>
	<div>Auto</div>
	<div>Auto</div>
		
</div>

<script>

	function flexGridFallback() { // Second approach: split all wrapped rows into separate .row.table
	
		var rows = document.querySelectorAll('.row'); // Node list to array
		var row_index = 0;
		
		for(;row_index < rows.length; row_index++) { // All rows
			
			var row = rows.item(row_index);

			var start_index = new Array('0');
			var end_index = new Array();
			var i = 1;
			for (;i <= row.children.length; i++) { // All columns in current row. Get start and end indices of each wrapped row.

				var el = row.children[i];
				if (i === row.children.length || el.offsetLeft === row.offsetLeft)  { // If offset is the same as the row, the row has wrapped and its columns must take up 100% width

					end_index[end_index.length] = i - 1;

/* 					console.log('Start: ' + start_index[start_index.length-1] + ', End: ' + end_index[end_index.length-1]); */

					start_index[start_index.length] = end_index[end_index.length-1] + 1;
		
				}
		
			}
			
			start_index.splice(start_index.length-1, 1); // Remove the last one

			for (i = 0; i < start_index.length; i++) {
				
				row.insertAdjacentHTML('beforeend', '<div class=table-row></div>');
				var j = start_index[i];
				while (j <= end_index[i]) {

					row.children[row.children.length-1].appendChild(row.children[0]);
					j++;
					
				}
				row.style.fontSize = 'inherit';
								
				
			}
			
		}

	}

	flexGridFallback();

</script>
